/*! ko-calendar.js v0.2.11 */
!function(a,b){"function"==typeof define&&define.amd?define(["knockout"],function(c){b.call(a,window,document,c)}):b.call(a,window,document,ko)}(this,function(a,b,c){var d="calendar",e={deepExtend:function(a,b){var c;for(c in b)b[c]&&b[c].constructor&&b[c].constructor===Object?(a[c]=a[c]||{},e.deepExtend(a[c],b[c])):a[c]=b[c];return a}},f=function(f){var g=this;return g.opts={value:c.observable(),current:new Date,deselectable:!0,showCalendar:!0,showToday:!0,showTime:!0,showNow:!0,militaryTime:!1,min:null,max:null,autoclose:!0,strings:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],time:["AM","PM"]}},e.deepExtend(g.opts,f),g.opts.showCalendar||g.opts.showTime?(g.constants={daysInWeek:7,dayStringLength:2},g.utils={date:{isValid:function(a){var b=new Date(a);return"[object Date]"!==Object.prototype.toString.call(b)?!1:!isNaN(b.getTime())},normalize:function(a){var b=new Date(a.getTime());return b.setHours(0,0,0,0),b},isSame:function(a,b){return a&&b?a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()&&a.getFullYear()==b.getFullYear():!1},isSameMonth:function(a,b){return a&&b?a.getMonth()==b.getMonth():!1},isWeekend:function(a){return a?0===a.getDay()||a.getDay()==g.constants.daysInWeek-1:!1},isWithinMinMaxDateRange:function(a){return a?g.opts.min||g.opts.max?g.opts.min&&g.utils.date.normalize(g.opts.min)>a?!1:g.opts.max&&g.utils.date.normalize(g.opts.max)<a?!1:!0:!0:!1}},time:{handleSuffixCheck:function(a){var b=a.getHours();return b>=12?b-=12:12>b&&(b+=12),a.setHours(b)},checkMinTimeRange:function(a){if(!a||!g.value()||!g.opts.min&&!g.opts.max)return!1;var b=new Date(g.value());return"hours"===a.type?b.setHours(b.getHours()-1):"minutes"===a.type?b.setMinutes(b.getMinutes()-1):"suffix"===a.type&&(b=g.utils.time.handleSuffixCheck(b)),g.opts.max&&g.opts.max<b?!0:g.opts.min&&g.opts.min>b?!0:!1},checkMaxTimeRange:function(a){if(!a||!g.value()||!g.opts.min&&!g.opts.max)return!1;var b=new Date(g.value());return"hours"===a.type?b.setHours(b.getHours()+1):"minutes"===a.type?b.setMinutes(b.getMinutes()+1):"suffix"===a.type&&(b=new Date(g.utils.time.handleSuffixCheck(b))),g.opts.min&&g.opts.min>b?!0:g.opts.max&&g.opts.max<b?!0:!1}},strings:{pad:function(a){return 10>a?"0"+a:a}},element:{offset:function(c){var d=c.getBoundingClientRect(),e=b.documentElement;return{top:d.top+a.pageYOffset-e.clientTop,left:d.left+a.pageXOffset-e.clientLeft}},height:function(a){return a.offsetHeight},isDescendant:function(a,b){for(var c=b.parentNode;null!==c;){if(c==a)return!0;c=c.parentNode}return!1}}},g.current=c.observable(g.opts.current||new Date),c.isObservable(g.opts.value)?(g.value=g.opts.value,g.opts.showToday&&!g.utils.date.isWithinMinMaxDateRange(g.utils.date.normalize(new Date))&&(g.opts.showToday=!1),g.opts.showNow&&(g.opts.min&&g.opts.min>=new Date||g.opts.max&&g.opts.max<=new Date)&&(g.opts.showNow=!1),g.calendar={select:function(a,b){return g.opts.deselectable&&g.utils.date.isSame(g.value(),a)?g.value(null):(g.opts.min&&g.utils.date.isSame(a,g.opts.min)?g.value(new Date(g.opts.min)):g.value(new Date(a)),void(g.input()&&g.opts.autoclose&&g.visible(!1)))},selectToday:function(a,b){var c=g.utils.date.normalize(new Date);g.calendar.select(c),g.current(c)},next:function(){var a=g.current();a.setDate(1),a.setMonth(a.getMonth()+1),g.current(new Date(a))},prev:function(){var a=g.current();a.setDate(1),a.setMonth(a.getMonth()-1),g.current(new Date(a))},sheet:c.computed(function(){var a=g.utils.date.normalize(g.current());a.setDate(1),a.setDate(a.getDate()-a.getDay());for(var b=[],c=0,d=!1,e=!1,f=!1;;){if(b[c]||(b[c]=[]),b[c].length!==g.constants.daysInWeek&&(b[c].push(new Date(a.getTime())),a.setDate(a.getDate()+1)),a.getMonth()==g.current().getMonth()&&(d=!0),d&&a.getMonth()!==g.current().getMonth()&&(e=!0),e&&b[c].length==g.constants.daysInWeek&&(f=!0),e&&f)break;b[c].length==g.constants.daysInWeek&&c++}return b})},g.time={next:function(a,b){return g.value()?void g.value(new Date(a.set(a.get()+1))):g.time.selectNow()},prev:function(a,b){return g.value()?void g.value(new Date(a.set(a.get()-1))):g.time.selectNow()},selectNow:function(){var a=new Date;g.value(a),g.current(a),g.input()&&g.opts.autoclose&&g.visible(!1)},sheet:c.observableArray([{type:"hours",get:function(){return g.value().getHours()},set:function(a){return g.value().setHours(a)}},{type:"minutes",get:function(){return g.value().getMinutes()},set:function(a){return g.value().setMinutes(a)}}]),text:function(a){if(!g.value())return"-";switch(a.type){case"suffix":return a.get()?g.opts.strings.time[1]:g.opts.strings.time[0];case"hours":var b=a.get();return!g.opts.militaryTime&&(b>12||0===b)&&(b-=12),Math.abs(b);default:return g.utils.strings.pad(a.get())}}},g.opts.militaryTime||g.time.sheet.push({type:"suffix",get:function(){return g.value()&&g.value().getHours()<12?0:1},set:function(a){var b=g.value().getHours();return b>=12?b-=12:12>b&&(b+=12),g.value().setHours(b)}}),g.input=c.observable(!1),void(g.visible=c.observable(!0))):console.error("value must be an observable")):console.error("Silly goose, what are you using ko-%s for?",d)},g='<div class="ko-calendar" data-bind="with: $data, visible: (opts.showCalendar || opts.showTime) && visible(), attr: { \'data-opts\': JSON.stringify(opts) } ">            <!-- ko if: opts.showCalendar -->            <table data-bind="css: { selected: value } " class="calendar-sheet">                <thead>                    <tr class="month-header">                        <th>                            <a href="#" data-bind="click: calendar.prev" class="prev">&laquo;</a>                        </th>                        <th data-bind="attr: { colspan: constants.daysInWeek - 2 } ">                            <b data-bind="text: opts.strings.months[current().getMonth()] + \' \' + current().getFullYear()"></b>                        </th>                        <th>                            <a href="#" data-bind="click: calendar.next" class="next">&raquo;</a>                        </th>                    </tr>                    <tr data-bind="foreach: opts.strings.days">                        <th data-bind="text: $data.substring(0, $parents[1].constants.dayStringLength)"></th>                    </tr>                </thead>                <tbody data-bind="foreach: calendar.sheet">                    <tr class="week" data-bind="foreach: $data">                        <td class="day" data-bind="css: { weekend: $parents[1].utils.date.isWeekend($data), today: $parents[1].utils.date.isSame(new Date(), $data), inactive: !($parents[1].utils.date.isSameMonth($parents[1].current(), $data)), outofrange: !($parents[1].utils.date.isWithinMinMaxDateRange($data)) } ">                            <a href="javascript:;" data-bind="text: $data.getDate(), attr: { title: $data }, click: $parents[1].calendar.select, css: { active: $parents[1].utils.date.isSame($parents[1].value(), $data) } "></a>                        </td>                    </tr>                </tbody>                <!-- ko if: opts.showToday -->                    <tfoot>                        <tr>                            <td data-bind="attr: { colspan: constants.daysInWeek } ">                                <a href="javascript:;" data-bind="click: calendar.selectToday">Today</a>                            </td>                        </tr>                    </tfoot>                <!-- /ko -->            </table>            <!-- /ko -->            <!-- ko if: opts.showTime -->            <table class="time-sheet">                <tbody>                    <tr data-bind="foreach: time.sheet">                        <td data-bind="css: { outofrange: $parent.utils.time.checkMaxTimeRange($data) }">                            <a href="#" class="up" data-bind="click: $parent.time.next"></a>                        </td>                    </tr>                    <tr data-bind="foreach: time.sheet">                        <td data-bind="css: { colon: $index() === 0, inactive: !$parent.value() }, text: $parent.time.text($data)"></td>                    </tr>                    <tr data-bind="foreach: time.sheet">                        <td data-bind="css: { outofrange: $parent.utils.time.checkMinTimeRange($data) }">                            <a href="#" class="down" data-bind="click: $parent.time.prev"></a>                        </td>                    </tr>                </tbody>                <!-- ko if: opts.showNow -->                    <tfoot>                        <tr>                            <td data-bind="attr: { colspan: time.sheet().length } ">                                <a href="javascript:;" data-bind="click: time.selectNow">Now</a>                            </td>                        </tr>                    </tfoot>                <!-- /ko -->            </table>            <!-- /ko -->        </div>',h=function(a,d){var e,h=new f(d);if("INPUT"==a.tagName){var i=b.createElement("div");i.innerHTML=g,e=i.children[0],b.body.appendChild(e),h.input(!0),h.visible(!1),c.utils.registerEventHandler(a,"focus",function(b){setTimeout(function(){var b=h.utils.element.offset(a),c=h.utils.element.height(a),d=[window.innerWidth-e.offsetWidth-20,b.left];e.style.position="absolute",e.style.top=b.top+c+5+"px",e.style.left=Math.min.apply(null,d)+"px"}),h.visible(!0)}),c.utils.registerEventHandler(a,"keydown",function(a){var b={9:!0,27:!0,46:!0,13:!0};a.which in b&&h.visible(!1)}),c.utils.registerEventHandler(b,"mousedown",function(b){b.target==a||b.target==e||h.utils.element.isDescendant(e,b.target)?a.focus():h.visible(!1)}),c.utils.registerEventHandler(a,"blur",function(a){if(""===a.target.value)return h.value(null);if(h.utils.date.isValid(a.target.value)){var b=new Date(a.target.value);(null===h.value()||h.value()&&h.value().getTime()!==b.getTime())&&h.value(b)}})}else a.innerHTML=g,e=a.children[0];c.applyBindings(h,e)};c.components.register(d,{viewModel:f,template:g}),c.bindingHandlers[d]={init:function(a,b){return h(a,c.unwrap(b())),{controlsDescendantBindings:!0}}},c[d]=h});